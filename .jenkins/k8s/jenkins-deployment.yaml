#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
apiVersion: v1
kind: ConfigMap
metadata:
  name: jenkins-operator-user-configuration
data:
  1-system-message.yaml: |
      tool:
        jdk:
          installations:
            - name: jdk_11_latest
              home: "/usr/bin/jdk_11/bin/java"
            - name: jdk_17_latest
              home: "/usr/bin/jdk_17/bin/java"
---  
apiVersion: jenkins.io/v1alpha2
kind: Jenkins
metadata:
  name: jenkins
spec:
  configurationAsCode:
    configurations:
    - name: jenkins-operator-user-configuration
    secret:
      name: ""
  groovyScripts:
    configurations: []
    secret:
      name: ""
  service:
    type: ClusterIP
    port: 8080
  jenkinsAPISettings:
    authorizationStrategy: createUser
  master:
    plugins:
    - name: ws-cleanup
      version: "0.45"
    - name: javadoc
      version: "243.vb_b_503b_b_45537"
    - name: description-setter
      version: "1.10"
    - name: throttle-concurrents
      version: "2.14"
    - name: test-stability
      version: "2.3"
    - name: postbuildscript
      version: "3.2.0-550.v88192b_d3e922"
    - name: github
      version: "1.37.3"
    - name: timestamper
      version: "1.26"
    - name: openJDK-native-plugin
      version: "1.7"
    - name: copyartifact
      version: "722.v0662a_9b_e22a_c"
    basePlugins:
    - name: kubernetes
      version: "4029.v5712230ccb_f8"
    - name: workflow-job
      version: "1342.v046651d5b_dfe"
    - name: workflow-aggregator
      version: "596.v8c21c963d92d"
    - name: git
      version: "5.2.0"
    - name: job-dsl
      version: "1.84"
    - name: configuration-as-code
      version: "1700.v6f448841296e"
    - name: kubernetes-credentials-provider
      version: "1.225.v14f9e6b_28f53"
    disableCSRFProtection: false
    containers:
      - name: jenkins-master
        image: jenkins/jenkins:2.414.1-lts-jdk11
        # env:
        #   - name: JAVA_OPTS
        #     value: "-Dhudson.cli.CLI.HTTPS=true -Djenkins.websocket=false"
        imagePullPolicy: Always
        livenessProbe:
          failureThreshold: 12
          httpGet:
            path: /login
            port: http
            scheme: HTTP
          initialDelaySeconds: 100
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        readinessProbe:
          failureThreshold: 10
          httpGet:
            path: /login
            port: http
            scheme: HTTP
          initialDelaySeconds: 80
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        resources:
          limits:
            cpu: 1500m
            memory: 3Gi
          requests:
            cpu: 500m
            memory: 500Mi
        env:
          - name: JOB_NAME
            value: <JOB_NAME>
          - name: REPO_URL
            value: <REPO_URL>
          - name: REPO_BRANCH
            value: <REPO_BRANCH>
    securityContext:
      fsGroup: 1000
      runAsUser: 1000
  seedJobs:
  - id: jenkins-operator
    targets: ".jenkins/seed.groovy"
    description: "Casandra Repo"
    repositoryBranch: <REPO_BRANCH>
    repositoryUrl: <REPO_URL>

