pipeline {
  agent('any')
  stages {
    stage('init') {
      steps {
        script { currentBuild.result='SUCCESS' }
        cleanWs()
      }
    }
    stage('jar') {
      steps {
        buildJob(".build/docker/_docker_run.sh bullseye-build.docker build-jars.sh", "")
      }
    }
    stage('Tests') {
      parallel {
         stage('artifacts') {
           steps {
             buildJob(".build/docker/build-artifacts.sh", "apache-cassandra-*.tar.gz,apache-cassandra-*.jar,apache-cassandra-*.pom")
           }
         }
         stage('lint') {
           steps {
             buildJob(".build/docker/check-code.sh", "")
           }
         }
      }
    }
  }
}
